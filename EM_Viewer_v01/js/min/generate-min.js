$(function(){var s=$("#map-image-area"),t=s.width(),a=s.height();s.css("pointer-events","none"),$('<div id="map-image-pane-1" class="map-image-pane"></div>').appendTo(s),$('<div id="map-image-pane-2" class="map-image-pane"></div>').appendTo(s);var n=$("#map-image-pane-1"),o=$("#map-image-pane-2"),i=$(".map-image-pane");i.css("transform-origin","0 0");var e=n,r=o,c=e.width(),l=e.height(),f=new Image,p=$(f),d=void 0,m=5,g=0,h=5,u=0,v=0,x=256,w=256,I=void 0,Y=void 0,X=0,b=0,C=void 0,T=!1,k=!1,R=!1,y=!1,z=!1,L=function(){f=new Image,mapImageRoot="generate-tiling-image/160408RatLiver_x7500_tiling01/tile-group"+h+"/",d=mapImageRoot+h+"-"+v+"-"+u+".jpg",mapImageClass=""+h+v+u,f.src=d,p=$(f),e.append(p),p.addClass("group"+h+" row"+v+" col"+u),I=p.width(),Y=p.height(),xmlSrc=mapImageRoot+"ImageProperties.txt",$.get(xmlSrc,function(s){console.log(s)})};L();var q=function(){f.onload=function(){0===v&&(b+=Y),0===u&&(X+=I),p.css({left:x*v,top:w*u,opacity:0}),Y*u>l?I*v>c?(v=0,u=0,ls()):(v++,u=0,q()):w>Y?x>I?(v=0,u=0,ls()):(v++,u=0,q()):(u++,q())}};q();var S=void 0,_=void 0,j=void 0,E=!1,H=!1,P=0,W=void 0,A=void 0,B=0,D=0,F=0,G=0,J=0,K=0,M=1,N=1,O=null,Q=500,U=0,V=0,Z=void 0,ss=void 0,ts=void 0,as=void 0,ns=void 0,os=void 0,is,es,rs,cs,ls=function(){void 0!==j&&j.remove(),j=e.find("img"),Z=j.first(),ts=Z.attr("class").slice(1,2),as=Z.attr("class").slice(2,3),ss=j.last(),mapImageLastWidth=I,mapImageLastHeight=Y,E=!1,H=!1,P=0,W=void 0,A=void 0,B=0,D=0,J=0,K=0,M=1,N=1,O=null,Q=500,U=(c-X)/2,V=(l-b)/2,j.css({left:"+="+U+"px",top:"+="+V+"px"}),is=F,es=G,void 0!==S&&(F=S-U,G=_-V),rs=F-is,cs=G-es,e.css({transision:"0s",transform:"translate3d("+F+"px, "+G+"px, 0) scale("+M+")"}),$(".figure.show").each(function(s){$(this).hasClass("horizontal")?$(this).css({top:$(this).offset().top-G,transition:"0s",transform:"scale(1)"}):$(this).hasClass("vertical")?$(this).css({left:$(this).offset().left-F,transition:"0s",transform:"scale(1)"}):$(this).hasClass("straight")?$(this).css({transition:"0s",left:$(this).offset().left-F,top:$(this).offset().top-G}):$(this).css({transition:"0s",left:$(this).offset().left-F,top:$(this).offset().top-G}),s===$(".figure.show").length-1&&gs.css({transition:"0s",transform:"translate3d("+F+"px, "+G+"px, 0) scale("+M+")"})}),gs.css({transition:"0s",transform:"translate3d("+F+"px, "+G+"px, 0) scale("+M+")"}),ms.css({transition:"0s",transform:"translate3d("+F+"px, "+G+"px, 0) scale("+M+")"}),j.css({opacity:1}),s.css({"pointer-events":"auto"})},fs=void 0,ps=function(t){s.css("pointer-events","none"),e.off("transitionend"),fs=e,e=r,r=fs,e.css({transition:"0s"}),B=0,D=0,S=j.eq(0).offset().left,_=j.eq(0).offset().top,M=1,N=1,u=0,v=0,X=0,b=0,q()},ds=2,ms=$("#waypoint-area"),gs=$("#figure-area"),hs=function(s){h>g&&(e.off("transitionend"),h--,N=M,M*=ds,F-=(s.pageX-F)*(M-N)/N,G-=(s.pageY-G)*(M-N)/N,e.css({transition:"0.3s",transform:"translate3d("+F+"px, "+G+"px, 0) scale("+M+")"}).on("transitionend",function(){console.log(e.offset().left),ps(s)}.bind(this)),ms.css({transition:"0.3s",transform:"translate3d("+F+"px, "+G+"px, 0) scale("+M+")"}),gs.css({transition:"0.3s",transform:"translate3d("+F+"px, "+G+"px, 0) scale("+M+")"}),$("#svg").css({transition:"0.3s",transform:"translate3d("+F+"px, "+G+"px, 0) scale("+M+")"}),$(".horizontal.show").css({transition:"0.3s",transform:"scaleY("+1/M+")"}),$(".vertical.show").css({transition:"0.3s",transform:"scaleX("+1/M+")"}))},us=function(s){m>h&&(e.off("transitionend"),h++,N=M,M/=ds,F-=(s.pageX-F)*(M-N)/N,G-=(s.pageY-G)*(M-N)/N,e.css({transition:"0.3s",transform:"translate3d("+F+"px, "+G+"px, 0) scale("+M+")"}).on("transitionend",function(){ps(s)}),ms.css({transition:"0.3s",transform:"translate3d("+F+"px, "+G+"px, 0) scale("+M+")"}),gs.css({transition:"0.3s",transform:"translate3d("+F+"px, "+G+"px, 0) scale("+M+")"}),$(".horizontal.show").css({transition:"0.3s",transform:"scaleY("+1/M+")"}),$(".vertical.show").css({transition:"0.3s",transform:"scaleX("+1/M+")"}))},vs=void 0,xs=function(){s.on({mousedown:function(t){E=!0,W=t.pageX,A=t.pageY,P++,1===P&&(s.on("mousedown.dblclick",function(t){s.off("mousedown.dblclick"),clearTimeout(O),O=null,P=0,hs(t)}),O=setTimeout(function(){O=null,s.off("mousedown.dblclick"),P=0},Q))},wheel:function(s){vs=s.originalEvent,vs.deltaY<0?hs(vs):us(vs)}}),$(window).on({mousemove:function(t){E&&(H=!0,s.off("mousedown.dblclick"),clearTimeout(O),O=null,P=0,B=F+t.pageX-W,D=G+t.pageY-A,e.css({transition:"0s",transform:"translate3d("+B+"px, "+D+"px, 0) scale("+M+")"}),ms.css({transition:"0s",transform:"translate3d("+B+"px, "+D+"px, 0) scale("+M+")"}),gs.css({transition:"0s",transform:"translate3d("+B+"px, "+D+"px, 0) scale("+M+")"}),0!==ts&&Z.offset().top>0)},mouseup:function(){E=!1,H&&(H=!1,F=B,G=D)}})};xs()});